(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08cc7242"],{"5e41":function(a,e,t){},7815:function(a,e,t){"use strict";var l=t("5e41"),i=t.n(l);i.a},bfd2:function(a,e,t){"use strict";t.r(e);var l=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"tw-template-wrapper"},[t("el-form",{staticClass:"tw-query-bar",attrs:{inline:!0,model:a.query,size:"small"}},[t("el-form-item",[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"主题"},model:{value:a.query.title,callback:function(e){a.$set(a.query,"title",e)},expression:"query.title"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:a.handleQueryClick}},[a._v("查询")]),t("el-button",{attrs:{type:"primary"},on:{click:a.handleAddClick}},[a._v("添加")])],1)],1),t("div",{staticClass:"tw-query-panel"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.table.loading,expression:"table.loading"}],staticClass:"tw-table",attrs:{data:a.filterTableList,border:"",size:"small",height:"calc(100% - 42px)"},on:{"row-click":a.handleTableRowClick}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center",resizable:!1}}),t("el-table-column",{attrs:{prop:"TIME",label:"时间",width:"140",align:"center"}}),t("el-table-column",{attrs:{prop:"SJZT",label:"主题","min-width":"180",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"BJR",label:"报警人",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"DJDH",label:"报警人电话",width:"140",align:"center"}}),t("el-table-column",{attrs:{prop:"JJR",label:"接警人",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"SJJB",label:"事件级别",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"SH",label:"状态",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"DB_TIME",label:"操作",width:"130",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",icon:"el-icon-check",size:"small"},on:{click:function(t){return a.handleDetailClick(e.row)}}}),t("el-button",{attrs:{type:"text",icon:"el-icon-edit",size:"small"},on:{click:function(t){return a.handleEditClick(e.row)}}}),t("el-button",{attrs:{type:"text",icon:"el-icon-delete",size:"small"},on:{click:function(t){return a.handleDeleteClick(e.row)}}})]}}])})],1),t("el-pagination",{staticClass:"tw-pagination",attrs:{background:"","page-size":a.table.pageSize,"current-page":a.table.currentPage,total:a.table.data.length,layout:"prev, pager, next,total"},on:{"current-change":a.handleTablePageCurrentChange}})],1),t("div",{staticClass:"tw-panel tw-panel-layout"},[t("div",{staticClass:"tw-panel tw-panel__left"},[t("div",{staticClass:"tw-panel__title"},[a._v("报警内容")]),t("div",{staticClass:"tw-panel__body"},[a._v(a._s(a.table.selectTableItem.SJJL))])]),t("div",{staticClass:"tw-panel__right"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:a.map.loading,expression:"map.loading"}],staticClass:"tw-map",attrs:{id:"gaodeMap"}})])]),t("el-dialog",{staticClass:"tw-dialog",attrs:{title:a.dialog.title,visible:a.dialog.display,width:"900px"},on:{"update:visible":function(e){return a.$set(a.dialog,"display",e)},closed:a.handleDialogClosed}},[t("div",{staticClass:"tw-panel tw-panel-layout"},[t("div",{staticClass:"tw-panel tw-panel__left"},[t("el-form",{attrs:{model:a.dialog.form,size:"small","label-width":"100px"}},[t("el-form-item",{attrs:{label:"事件编号"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"事件编号"},model:{value:a.dialog.form.sjbh,callback:function(e){a.$set(a.dialog.form,"sjbh",e)},expression:"dialog.form.sjbh"}})],1),t("el-form-item",{attrs:{label:"事件主题"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"事件主题"},model:{value:a.dialog.form.sjzt,callback:function(e){a.$set(a.dialog.form,"sjzt",e)},expression:"dialog.form.sjzt"}})],1),t("el-form-item",{attrs:{label:"发生地址"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"点击地图自动获取",disabled:""},model:{value:a.dialog.form.fsdz,callback:function(e){a.$set(a.dialog.form,"fsdz",e)},expression:"dialog.form.fsdz"}})],1),t("el-form-item",{attrs:{label:"经纬度"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"经纬度",disabled:""},model:{value:a.dialog.form.jwdxx,callback:function(e){a.$set(a.dialog.form,"jwdxx",e)},expression:"dialog.form.jwdxx"}})],1),t("el-form-item",{attrs:{label:"报警人"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"报警人"},model:{value:a.dialog.form.bjr,callback:function(e){a.$set(a.dialog.form,"bjr",e)},expression:"dialog.form.bjr"}})],1),t("el-form-item",{attrs:{label:"报警人电话"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"报警人电话"},model:{value:a.dialog.form.bjdh,callback:function(e){a.$set(a.dialog.form,"bjdh",e)},expression:"dialog.form.bjdh"}})],1),t("el-form-item",{attrs:{label:"接警人"}},[t("el-input",{staticClass:"inline-input",attrs:{placeholder:"接警人"},model:{value:a.dialog.form.jjr,callback:function(e){a.$set(a.dialog.form,"jjr",e)},expression:"dialog.form.jjr"}})],1),t("el-form-item",{attrs:{label:"事件级别"}},[t("el-select",{staticClass:"inline-input",attrs:{placeholder:"事件级别"},model:{value:a.dialog.form.sjjb,callback:function(e){a.$set(a.dialog.form,"sjjb",e)},expression:"dialog.form.sjjb"}},[t("el-option",{attrs:{value:"一级",label:"一级"}}),t("el-option",{attrs:{value:"二级",label:"二级"}}),t("el-option",{attrs:{value:"三级",label:"三级"}})],1)],1),t("el-form-item",{attrs:{label:"接警方式"}},[t("el-select",{staticClass:"inline-input",attrs:{placeholder:"接警方式"},model:{value:a.dialog.form.bjfs,callback:function(e){a.$set(a.dialog.form,"bjfs",e)},expression:"dialog.form.bjfs"}},[t("el-option",{attrs:{value:"电话报警",label:"电话报警"}}),t("el-option",{attrs:{value:"短信报警",label:"短信报警"}}),t("el-option",{attrs:{value:"110联动",label:"110联动"}}),t("el-option",{attrs:{value:"12328转入",label:"12328转入"}}),t("el-option",{attrs:{value:"12345转入",label:"12345转入"}}),t("el-option",{attrs:{value:"领导指定",label:"领导指定"}}),t("el-option",{attrs:{value:"相关部门指定",label:"相关部门指定"}}),t("el-option",{attrs:{value:"系统预警",label:"系统预警"}})],1)],1),t("el-form-item",{attrs:{label:"报警内容"}},[t("el-input",{staticClass:"inline-input",attrs:{type:"textarea",placeholder:"报警内容"},model:{value:a.dialog.form.bjnr,callback:function(e){a.$set(a.dialog.form,"bjnr",e)},expression:"dialog.form.bjnr"}})],1),t("el-form-item",{attrs:{label:"事件记录"}},[t("el-input",{staticClass:"inline-input",attrs:{type:"textarea",placeholder:"事件记录"},model:{value:a.dialog.form.sjjl,callback:function(e){a.$set(a.dialog.form,"sjjl",e)},expression:"dialog.form.sjjl"}})],1)],1)],1),t("div",{staticClass:"tw-map",attrs:{id:"gaodeMap_dialog"}})]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){a.dialog.display=!1}}},[a._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:a.handleDialogSaveClick}},[a._v("提 交")])],1)])],1)},i=[],s=t("17fb"),o=t.n(s),n=t("bc3a"),r=t.n(n),d={name:"AbnormalDisposalProcess",data:function(){return{query:{title:""},table:{selectItem:{},selectTableItem:{},loading:!1,data:[],pageSize:10,currentPage:1},map:{amap:null,amap2:null,loading:!1,center:[120.170076,30.277559],mapMarker:null,mapMarker2:null,geocoder:null},dialog:{title:"",display:!1,form:{sjbh:"",sjzt:"",fsdz:"",jwdxx:"",bjr:"",bjdh:"",jjr:"",sjjb:"",bjfs:"",bjnr:"",sjjl:""}}}},mounted:function(){var a=this;this.findAbnormalDisposalProcess(),this.$nextTick((function(){setTimeout((function(){a.initMap()}),300)}))},computed:{filterTableList:function(){var a=this.table,e=a.data,t=a.pageSize,l=a.currentPage,i=l-1;return o.a.filter(e,(function(a,e){return e>=i*t&&e<l*t}))}},methods:{findAbnormalDisposalProcess:function(){var a=this,e=this.query.title;this.table.loading=!0,null!=this.map.mapMarker&&this.map.mapMarker.setMap(null),this.table.selectTableItem={},r.a.get("keyArea/findAbnormalDisposalProcess",{baseURL:this.baseURL,params:{sjzt:e}}).then((function(e){a.table.data=e.data||[],a.table.total=a.table.data.length,a.table.currentPage=1,a.table.loading=!1})).catch((function(a){console.log(a)}))},addAbnormalDisposalProcess:function(){var a=this,e=this.dialog.form,t=e.sjbh,l=e.sjzt,i=e.fsdz,s=e.jwdxx,o=e.bjr,n=e.bjdh,d=e.jjr,c=e.sjjb,p=e.bjfs,m=e.bjnr,u=e.sjjl;if(""===t||""===l||""===i||""===s||""===o||""===n||""===d||""===c||""===p||""===m||""===u)return this.$message.error("请填写完整信息！"),!1;var b=new URLSearchParams;b.append("sjbh",t),b.append("sjzt",l),b.append("fsdz",i),b.append("jwdxx",s),b.append("bjr",o),b.append("bjdh",n),b.append("jjr",d),b.append("sjjb",c),b.append("bjfs",p),b.append("bjnr",m),b.append("sjjl",JSON.stringify(u)),r.a.post(this.baseURL+"keyArea/addAbnormalDisposalProcess",b,{}).then((function(e){e.data>0?(a.$message({message:"操作成功!",type:"success"}),a.dialog.display=!1,a.findAbnormalDisposalProcess()):0===e.data?a.$message.error("操作失败！"):-1===e.data&&a.$message.error("该已添加！")})).catch((function(a){console.error(a)}))},updateAbnormalDisposalProcess:function(){var a=this,e=this.table.selectItem,t=this.dialog.form,l=t.sjbh,i=t.sjzt,s=t.fsdz,o=t.jwdxx,n=t.bjr,d=t.bjdh,c=t.jjr,p=t.sjjb,m=t.bjfs,u=t.bjnr,b=t.sjjl;if(""===l||""===i||""===s||""===o||""===n||""===d||""===c||""===p||""===m||""===u||""===b)return this.$message.error("请填写完整信息！"),!1;var f=new URLSearchParams;f.append("sjbh",l),f.append("sjzt",i),f.append("fsdz",s),f.append("jwdxx",o),f.append("bjr",n),f.append("bjdh",d),f.append("jjr",c),f.append("sjjb",p),f.append("bjfs",m),f.append("bjnr",u),f.append("sjjl",JSON.stringify(b)),f.append("id",e.ID),r.a.post(this.baseURL+"keyArea/updateAbnormalDisposalProcess",f,{}).then((function(e){e.data>0?(a.$message({message:"操作成功!",type:"success"}),a.dialog.display=!1,a.findAbnormalDisposalProcess()):0===e.data?a.$message.error("操作失败！"):-1===e.data&&a.$message.error("该已添加！")})).catch((function(a){console.error(a)}))},addMapMarker:function(a){null!=this.map.mapMarker&&this.map.mapMarker.setMap(null),this.map.mapMarker=new AMap.Marker({map:this.map.amap,offset:new AMap.Pixel(-14,-18),position:new AMap.LngLat(a.PX,a.PY),draggable:!1}),this.map.amap.setCenter([a.PX,a.PY])},addMapMarker2:function(a){null!=this.map.mapMarker2&&this.map.mapMarker2.setMap(null),this.map.mapMarker2=new AMap.Marker({map:this.map.amap2,offset:new AMap.Pixel(-14,-18),position:new AMap.LngLat(a.PX,a.PY),draggable:!1}),this.map.amap2.setCenter([a.PX,a.PY])},handleQueryClick:function(){this.findAbnormalDisposalProcess()},handleAddClick:function(){var a=this;this.dialog.title="添加",this.dialog.display=!0,setTimeout((function(){a.initDialogMap()}),0)},handleDetailClick:function(a){var e=this;this.$confirm("确定审核吗?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then((function(){r.a.get("keyArea/auditAbnormalDisposalProcess",{baseURL:e.baseURL,params:{id:a.ID}}).then((function(a){a.data>0?(e.$message({message:"操作成功!",type:"success"}),e.findAbnormalDisposalProcess()):e.$message.error("操作失败！")})).catch((function(a){console.error(a)}))})).catch((function(){}))},handleEditClick:function(a){var e=this;this.dialog.title="修改",this.table.selectItem=a,this.dialog.form.sjbh=a.SJBH,this.dialog.form.sjzt=a.SJZT,this.dialog.form.fsdz=a.ADDRESS,this.dialog.form.jwdxx=a.PX+","+a.PY,this.dialog.form.bjr=a.BJR,this.dialog.form.bjdh=a.DJDH,this.dialog.form.jjr=a.JJR,this.dialog.form.sjjb=a.SJJB,this.dialog.form.bjfs=a.BJFS,this.dialog.form.bjnr=a.SJNR,this.dialog.form.sjjl=a.SJJL,this.dialog.display=!0,setTimeout((function(){e.initDialogMap(),e.addMapMarker2(e.table.selectItem)}),0)},handleDialogSaveClick:function(){"修改"===this.dialog.title?this.updateAbnormalDisposalProcess():"添加"===this.dialog.title&&this.addAbnormalDisposalProcess()},handleDeleteClick:function(a){var e=this;this.$confirm("是否删除?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then((function(){r.a.get("keyArea/deleteAbnormalDisposalProcess",{baseURL:e.baseURL,params:{id:a.ID}}).then((function(a){a.data>0?(e.$message({message:"操作成功!",type:"success"}),e.findAbnormalDisposalProcess()):e.$message.error("操作失败！")})).catch((function(a){console.error(a)}))})).catch((function(){}))},handleTablePageCurrentChange:function(a){this.table.currentPage=a},handleTableRowClick:function(a){this.table.selectTableItem=a,this.addMapMarker(a)},handleDialogClosed:function(){this.dialog.title="",this.dialog.form.sjbh="",this.dialog.form.sjzt="",this.dialog.form.fsdz="",this.dialog.form.jwdxx="",this.dialog.form.bjr="",this.dialog.form.bjdh="",this.dialog.form.jjr="",this.dialog.form.sjjb="",this.dialog.form.bjfs="",this.dialog.form.bjnr="",this.dialog.form.sjjl="",this.table.selectItem={}},initMap:function(){this.map.amap=new AMap.Map("gaodeMap",{center:this.map.center,resizeEnable:!0,zoom:13})},initDialogMap:function(){this.map.amap2=new AMap.Map("gaodeMap_dialog",{center:this.map.center,resizeEnable:!0,zoom:13});var a=this;this.map.amap2.on("click",(function(e){var t={};a.dialog.form.jwdxx=e.lnglat.getLng()+","+e.lnglat.getLat(),t.PX=e.lnglat.getLng(),t.PY=e.lnglat.getLat(),a.addMapMarker2(t),a.getRealAddress([t.PX,t.PY])}))},getRealAddress:function(a){this.map.geocoder||(this.map.amap2.plugin("AMap.Geocoder",(function(){})),this.map.geocoder=new AMap.Geocoder({city:"010",radius:1e3}));var e=this;this.map.geocoder.getAddress(a,(function(a,t){"complete"===a&&t.regeocode&&(e.dialog.form.fsdz=t.regeocode.formattedAddress)}))}}},c=d,p=(t("7815"),t("2877")),m=Object(p["a"])(c,l,i,!1,null,"690e52ab",null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-08cc7242.50a11abc.js.map